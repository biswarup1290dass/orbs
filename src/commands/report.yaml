description: download report from scribe service
parameters:
  config:
    description: Config of the application
    default: ""
    type: string
  context-type:
    description: Context type, options=[jenkins github local]
    default: local
    type: string
  integrity:
    description: Select report integrity, options=[Modified Not_Covered Validated Not_Validated]
    default: Modified,Not_Covered,Validated,Not_Validated
    type: string
  output-directory:
    description: Output directory path
    default: /home/samtholiya/.cache/valint
    type: string
  output-file:
    description: Output file path
    default: ""
    type: string
  scribe-enable:
    description: 'Enable scribe client'
    default: false
    type: boolean
  scribe-clientid:
    description: 'Scribe client id'
    type: string
    default: ""
  scribe-clientsecret:
    description: 'Scribe access token'
    type: string
    default: ""
  scribe-url:
    description: 'Scribe url'
    type: string
    default: ""
  scribe-loginurl:
    description: 'Scribe auth login url'
    type: string
    default: ""
  scribe-audience:
    description: 'Scribe auth audience'
    type: string
    default: ""
  section:
    description: Select report sections, options=[files packages packages-files summary stat]
    default: files,packages,packages-files,summary,stat
    type: string
  verbose:
    description: Increase verbosity (-v = info, -vv = debug)
    default: 1
    type: integer
steps:
- run:
    name: download report from scribe service
    command: |
      valint report \
        <<# parameters.integrity >>--integrity << parameters.integrity >><</ parameters.integrity >> \
        <<# parameters.section >>--section << parameters.section >><</ parameters.section >> \
        <<# parameters.config >>--config << parameters.config >><</ parameters.config >> \
        <<# parameters.context-type >>--context-type << parameters.context-type >><</ parameters.context-type >> \
        <<# parameters.output-directory >>--output-directory << parameters.output-directory >><</ parameters.output-directory >> \
        <<# parameters.output-file >>--output-file << parameters.output-file >><</ parameters.output-file >> \
        <<# parameters.scribe-clientid >>--scribe.clientid << parameters.scribe-clientid >><</ parameters.scribe-clientid  >> \
        <<# parameters.scribe-clientsecret >>--scribe.clientsecret << parameters.scribe-clientsecret >><</ parameters.scribe-clientsecret  >> \
        <<# parameters.scribe-enable  >>--scribe.enable << parameters.scribe-enable >><</ parameters.scribe-enable  >> \
        <<# parameters.scribe-url  >>--scribe.url << parameters.scribe-url >><</ parameters.scribe-url  >> \
        <<# parameters.scribe-audience  >>--scribe.auth.audience << parameters.scribe-audience >><</ parameters.scribe-audience  >> \
        <<# parameters.scribe-loginurl  >>--scribe.loginurl << parameters.scribe-loginurl >><</ parameters.scribe-loginurl  >>
        <<# parameters.verbose >>--verbose << parameters.verbose >><</ parameters.verbose >>
