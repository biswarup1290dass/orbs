description: >
  Generate a SBOM for source and image,
  Upload sbom to scribe and download integrity report.

usage:
  version: 2.1
  orbs:
    scribe: scribe-security/orbs@1.2.3

  workflows:
    scribe-service-job:
      jobs:
        - checkout
        - scribe/install
        - run:
            name: custom checkout
            command: |
              git clone -b v1.0.0-alpha.4 --single-branch https://github.com/mongo-express/mongo-express.git --depth=1 mongo-express-scm
        - scribe/bom:
            target: dir:mongo-express-scm
            verbose: 2
            scribe-enable: true
            scribe-client-id: $SCRIBE_CLIENT_ID
            scribe-client-secret: $SCRIBE_CLIENT_SECRET
        - scribe/bom:
            target: mongo-express:1.0.0-alpha.4
            verbose: 2
            scribe-enable: true
            scribe-client-id: $SCRIBE_CLIENT_ID
            scribe-client-secret: $SCRIBE_CLIENT_SECRET
